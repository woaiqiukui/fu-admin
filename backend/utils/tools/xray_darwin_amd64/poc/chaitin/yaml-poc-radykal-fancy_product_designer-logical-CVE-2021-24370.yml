name: poc-yaml-wordpress-fancy-product-designer-cve-2021-24370-fileupload
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-content/plugins/fancy-product-designer/inc/custom-image-handler.php
            follow_redirects: true
        expression: response.status == 200 && response.body_string.contains("{\"error\":\"You need to define a directory") && response.content_type.contains("text/html")
expression: r0()
detail:
    author: Â∞èz
    links:
        - https://www.wordfence.com/blog/2021/06/critical-0-day-in-fancy-product-designer-under-active-attack/
    vulnerability:
        level: critical